<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Towel Checklist</title>

<link rel="manifest" href="manifest.json" />
<meta name="theme-color" content="#1a73e8" />

<style>
  :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  body{margin:0;padding:18px;background:#ffffff;color:#111}
  header{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
  h1{color:#1a73e8;margin:0;font-size:1.6rem}
  .small{color:#666;font-size:0.9rem}
  .controls{margin-top:12px;display:flex;gap:8px;flex-wrap:wrap}
  input[type="date"]{padding:6px;border:1px solid #ccc;border-radius:6px}
  button{background:#1a73e8;color:#fff;padding:8px 12px;border:0;border-radius:6px}
  .fullpage{margin-top:18px}
  table{width:100%;border-collapse:collapse}
  th,td{border:1px solid #ccc;padding:10px;text-align:left;vertical-align:top}
  th{background:#f7f7f7}
  .item-name{width:35%}
  .hairdryer-col{width:18%}
  .check-col{width:15%}
  .actions{margin-top:12px;display:flex;gap:8px}
  @media(min-width:900px){body{max-width:900px;margin:0 auto}}
</style>
</head>
<body>
<header>
  <div>
    <h1>Towel Checklist</h1>
    <div class="small">เก็บข้อมูลบนเครื่อง (ไม่ต้องพิมพ์กระดาษ)</div>
  </div>
</header>

<div class="controls">
  วันที่: <input id="dateField" type="date" />
  <div class="actions">
    <button id="saveBtn">Save</button>
    <button id="resetBtn" style="background:#777">Reset</button>
  </div>
</div>

<div class="fullpage">
  <table id="checklistTable" aria-label="Towels and linen checklist">
    <thead>
      <tr>
        <th class="item-name">Item</th>
        <th class="check-col">Check in</th>
        <th class="check-col">Mid week - Laundry Match</th>
        <th class="check-col">Mid week - Towel Setup</th>
        <th class="check-col">Check out</th>
        <th class="hairdryer-col">Hair Dryer (separate)</th>
        <th class="check-col">Checked by (Check in)</th>
        <th class="check-col">Checked by (Check out)</th>
      </tr>
    </thead>
    <tbody id="tbodyItems"></tbody>
  </table>
</div>

<script>
/* --- รายการตามที่ขอ: bed sheet after Blanket, hairdryer แยกคอลัมน์ --- */
const ITEMS = [
  "White Bath Towel",
  "Blue Bath Towel",
  "White Face Towel",
  "Blue Face Towel",
  "Pool Towel",
  "Pillowcase",
  "Blanket",
  "Bed Sheet",
  "Floor Towel",
  "Kitchen Towel"
];

const dateField = document.getElementById('dateField');
const tbody = document.getElementById('tbodyItems');
const saveBtn = document.getElementById('saveBtn');
const resetBtn = document.getElementById('resetBtn');

const STORAGE_KEY = 'towel_checklist_data_v1';

function createRow(name, saved={}){
  const tr = document.createElement('tr');

  const tdName = document.createElement('td');
  tdName.textContent = name;
  tr.appendChild(tdName);

  function makeCell(key){
    const td = document.createElement('td');
    const inp = document.createElement('input');
    inp.type = 'text';
    inp.value = saved[key] || '';
    inp.placeholder = '';
    td.appendChild(inp);
    td.dataset.key = key;
    td.querySelector = () => inp;
    return td;
  }

  tr.appendChild(makeCell('check_in'));
  tr.appendChild(makeCell('mid_laundry'));
  tr.appendChild(makeCell('mid_setup'));
  tr.appendChild(makeCell('check_out'));

  // Hair dryer separate column (not per linen)
  const tdHair = document.createElement('td');
  if(name.toLowerCase().includes('hair dryer')){
    // if there is a hairdryer item - input enabled
    const hInput = document.createElement('input');
    hInput.type = 'text';
    hInput.value = saved.hair || '';
    tdHair.appendChild(hInput);
  } else {
    // otherwise empty cell
    tdHair.textContent = '';
  }
  tr.appendChild(tdHair);

  tr.appendChild(makeCell('checked_by_in'));
  tr.appendChild(makeCell('checked_by_out'));

  return tr;
}

function render(savedData={}){
  tbody.innerHTML = '';
  // Add rows for each item
  ITEMS.forEach(name=>{
    const rowSaved = savedData[name] || {};
    tbody.appendChild(createRow(name, rowSaved));
  });
  // Add a separate Hair Dryer item row (if you want hair dryer as separate item)
  const hairRow = document.createElement('tr');
  const nameTd = document.createElement('td');
  nameTd.textContent = 'Hair Dryer';
  hairRow.appendChild(nameTd);
  // fill the other columns empty except the hairdryer column
  for(let i=0;i<4;i++){ hairRow.appendChild(document.createElement('td')) }
  const hairTd = document.createElement('td');
  const hairInput = document.createElement('input');
  hairInput.type = 'text';
  hairInput.id = 'hairInput';
  hairInput.value = (savedData['_hair']||'');
  hairTd.appendChild(hairInput);
  hairRow.appendChild(hairTd);
  hairRow.appendChild(document.createElement('td'));
  hairRow.appendChild(document.createElement('td'));
  tbody.appendChild(hairRow);
}

function load(){
  const raw = localStorage.getItem(STORAGE_KEY);
  if(raw){
    try{
      const parsed = JSON.parse(raw);
      if(parsed.date) dateField.value = parsed.date;
      render(parsed.items || {});
    }catch(e){
      console.warn('parse fail',e);
      render();
    }
  } else {
    render();
  }
}

function collect(){
  const rows = [...tbody.querySelectorAll('tr')];
  const items = {};
  rows.forEach(tr=>{
    const name = tr.children[0].textContent.trim();
    // hair dryer row handled separately by id
    if(name === 'Hair Dryer') return;
    items[name] = {
      check_in: tr.children[1].querySelector().value || '',
      mid_laundry: tr.children[2].querySelector().value || '',
      mid_setup: tr.children[3].querySelector().value || '',
      check_out: tr.children[4].querySelector().value || '',
      // hair cell left blank for linen rows
      checked_by_in: tr.children[6].querySelector().value || '',
      checked_by_out: tr.children[7].querySelector().value || ''
    };
  });
  const hairVal = document.getElementById('hairInput') ? document.getElementById('hairInput').value : '';
  return {
    date: dateField.value || '',
    items: items,
    _hair: hairVal
  };
}

saveBtn.addEventListener('click', ()=>{
  const payload = collect();
  localStorage.setItem(STORAGE_KEY, JSON.stringify(payload));
  alert('Saved locally ✅');
});

resetBtn.addEventListener('click', ()=>{
  if(confirm('Reset all saved data?')){
    localStorage.removeItem(STORAGE_KEY);
    dateField.value = '';
    render();
  }
});

// load on start
load();
</script>
</body>
</html>
